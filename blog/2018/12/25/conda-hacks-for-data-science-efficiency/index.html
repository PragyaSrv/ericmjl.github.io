<!doctype html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <!-- Bootstrap v4beta Imports -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <style media="screen">
        body {
            padding-top: 70px;
            padding-bottom: 70px;
        }

    </style>
    <!-- Import stylesheet -->
    <link rel="stylesheet" href="../../../../../static/pygments.css">

    
<!-- Syntax Highlighter. Use both pygments and hl.js. -->
<link rel="stylesheet" href="../../../../../static/pygments.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


    <!-- Google Analytics -->
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-12498603-2', 'auto');
        ga('send', 'pageview');
    </script>

    <!-- ClustrMaps Tracking -->
    <!-- <script type="text/javascript" id="clstr_globe" src="//cdn.clustrmaps.com/globe.js?d=nhKoDpoTjWz4pC6CwI-fSy4hPoJ1uXwTLCfMCT3OK_8"></script> -->

    <!-- FontAwesome embed -->
    <!-- <script src="https://use.fontawesome.com/cb9dbe8e41.js"></script> -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.1/css/all.css"
        integrity="sha384-O8whS3fhG2OnA5Kas0Y9l3cfpmYjapjI0E4theH4iuMD+pLhbf6JI0jIMfYcK3yZ" crossorigin="anonymous">

    <!-- Highlight.js Nord Theme -->
    <link href="https://unpkg.com/nord-highlightjs@0.1.0/dist/nord.css" rel="stylesheet" type="text/css" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/custom.css">

    <!-- Mathjax -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
        </script>

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>

</head>

<title>Conda hacks for data science efficiency - Eric J. Ma's Personal Site</title>

<body class="body">
    <nav class="navbar navbar-expand-sm navbar-dark fixed-top bg-dark-nord">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
            data-target="#local-links" aria-controls="navbarSupportedContent" aria-expanded="false"
            aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="local-links">
            <ul class="navbar-nav mr-auto">
                
                <li class="nav-item">
                    <a class="nav-link" href="/"><i class="fa fa-home"
                            aria-hidden="true"></i> Home</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://ericmjl.github.io/resume"><i class="fa far fa-file-alt"
                            aria-hidden="true"></i> Resume</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="/blog"><i class="fa fas fa-pen"
                            aria-hidden="true"></i> Blog</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="/open-source"><i class="fa fa-code"
                            aria-hidden="true"></i> Open Source</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="/projects"><i class="fa fa-briefcase"
                            aria-hidden="true"></i> Projects</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="/talks"><i class="fa fa-microphone"
                            aria-hidden="true"></i> Talks</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="/teaching"><i class="fa fa-university"
                            aria-hidden="true"></i> Teaching</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="/bio"><i class="fa fa-user"
                            aria-hidden="true"></i> Bio</a>
                </li>
                
            </ul>
        </div>
    </nav>
    <div class="container">
        

<div>
  
<!-- Set title style -->

<h1>Conda hacks for data science efficiency</h1>


<!-- Append author -->
<small class="text-muted">
  <p>
    written by
    
    <a class="author" href="https://twitter.com/ericmjl">Eric J. Ma</a>
    
    on 2018-12-25

    
    | tags:
    <!-- Append tags after author -->
    <i class="fas fa-tag"></i>
    <a class="tags" href="../../../../../blog/tag/data science/">
      data science
    </a>
    <i class="fas fa-tag"></i>
    <a class="tags" href="../../../../../blog/tag/conda/">
      conda
    </a>
    <i class="fas fa-tag"></i>
    <a class="tags" href="../../../../../blog/tag/hacks/">
      hacks
    </a>
    
  </p>
  
</small>


  <!-- Put post body -->
  <p>The <code>conda</code> package manager has, over the years, become an integral part of my workflow. I use it to manage project environments, and have built a bunch of very simple hacks around it that you can adopt too. I'd like to share them with you, alongside the rationale for using them.</p>
<h2 id="hack-1:-set-up-your-.condarc">Hack #1: Set up your <code>.condarc</code></h2><p><strong>Why?</strong> It will save you a few keystrokes each time you want to do something with <code>conda</code>. For example, in my <code>.condarc</code>, I have the following:</p>
<div class="hll"><pre><span></span><span class="c1"># Set the channels that the `conda install` command will </span>
<span class="c1"># automatically search through.</span>
<span class="nt">channels</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">defaults</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">conda-forge</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ericmjl</span>

<span class="c1"># Always accept installation. Is convenient, but always </span>
<span class="c1"># double-check!</span>
<span class="nt">always_yes</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
<p>For more information on how to configure your <code>.condarc</code>, check the <a href="https://conda.io/docs/user-guide/configuration/use-condarc.html">online documentation</a>!</p>
<h2 id="hack-2:-use-one-environment-spec-file-per-project">Hack #2: Use one environment spec file per project</h2><p>This assumes that you have the habit of putting all files related to one project inside one folder, using subdirectories for finer-grained organization.</p>
<p><strong>Why?</strong> It will ensure that you have one version-controlled, authoritative specification for the packages that are associated with the project. This is good for (1) reproducibility, as you can send it to a colleague and have them reproduce the environment, and (2) will enable Hack #3, which I will showcase afterwards.</p>
<div class="hll"><pre><span></span><span class="c1"># file name: environment.yml</span>

<span class="c1"># Give your project an informative name</span>
<span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">project-name</span>

<span class="c1"># Specify the conda channels that you wish to grab packages from, in order of priority.</span>
<span class="nt">channels</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">defaults</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">conda-forge</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ericmjl</span>

<span class="c1"># Specify the packages that you would like to install inside your environment. Version numbers are allowed, and conda will automatically use its dependency solver to ensure that all packages work with one another.</span>
<span class="nt">dependencies</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">python=3.7</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">conda</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">jupyterlab</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">scipy</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">numpy</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">pandas</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">pyjanitor</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">pandas</span>
<span class="c1"># There are some packages which are not conda-installable. You can put the pip dependencies here instead.</span>
<span class="p p-Indicator">-</span> <span class="nt">pip</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">tqdm</span>  <span class="c1"># for example only, tqdm is actually available by conda.</span>
</pre></div>
<p>A hack that I have related to this is that I use TextExpander shortcut to populate a starting environment spec file.</p>
<p>Additionally, if I want to install a new package, rather than simply typing <code>conda install &lt;packagename&gt;</code>, I will add the package to the environment spec file, and then type <code>conda env update -f environment.yml</code>, as more often than not, my default is to continue using the package I added.</p>
<p>For more details on what the environment spec file is all about, <a href="https://conda.io/docs/user-guide/tasks/manage-environments.html#create-env-file-manually">read the online docs</a>!</p>
<h2 id="hack-3:-use-conda-auto-env">Hack 3: use <code>conda-auto-env</code></h2><p>Written by <a href="https://chdoig.github.io">Christine Doig</a>, <a href="https://github.com/chdoig/conda-auto-env"><code>conda-auto-env</code></a> is a bash hack that enables you to automatically activate an environment once you enter into a project directory, <em>as long as an <code>environment.yml</code> file already exists in the directory</em>. If the environment does not already exist, then <code>conda-auto-env</code> will automatically create one based on the <code>environment.yml</code> file in your project directory.</p>
<p><strong>Why?</strong> If you have many projects that you are working on, then it will greatly reduce the amount of effort used to remember which project to activate.</p>
<p><code>conda-auto-env</code> looks like this:</p>
<div class="hll"><pre><span></span><span class="c1"># File: .conda-auto-env</span>
<span class="c1">#!/bin/bash</span>

<span class="k">function</span> conda_auto_env<span class="o">()</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">[</span> -e <span class="s2">&quot;environment.yml&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="c1"># echo &quot;environment.yml file found&quot;</span>
    <span class="nv">ENV</span><span class="o">=</span><span class="k">$(</span>head -n <span class="m">1</span> environment.yml <span class="p">|</span> cut -f2 -d <span class="s1">&#39; &#39;</span><span class="k">)</span>
    <span class="c1"># Check if you are already in the environment</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$PATH</span> !<span class="o">=</span> *<span class="nv">$ENV</span>* <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      <span class="c1"># Check if the environment exists</span>
      conda activate <span class="nv">$ENV</span>
      <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -eq <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        :
      <span class="k">else</span>
        <span class="c1"># Create the environment and activate</span>
        <span class="nb">echo</span> <span class="s2">&quot;Conda env &#39;</span><span class="nv">$ENV</span><span class="s2">&#39; doesn&#39;t exist.&quot;</span>
        conda env create -q
        conda activate <span class="nv">$ENV</span>
      <span class="k">fi</span>
    <span class="k">fi</span>
  <span class="k">fi</span>
<span class="o">}</span>

<span class="nb">export</span> <span class="nv">PROMPT_COMMAND</span><span class="o">=</span>conda_auto_env
</pre></div>
<p>To use it, you have two options. You can either copy/paste the whole original script into your <code>.bashrc</code>, or you can put it in a file called <code>.conda-auto-env</code>, and source it from your <code>.bashrc</code>. I recommend the latter, as it makes managing your <code>.bashrc</code> easier:</p>
<div class="hll"><pre><span></span><span class="c1"># File: .bashrc</span>
<span class="nb">source</span> /path/to/.conda-auto-env
</pre></div>
<h2 id="hack-4:-hijack-bash-aliases-for-conda-commands">Hack 4: hijack bash aliases for <code>conda</code> commands</h2><p>I use aliases to save myself a few keystrokes whenever I'm at the terminal. This is a generalizable bash hack, but here it is as applied to <code>conda</code> commands.</p>
<p>Anyways, these are the commands that I use most often, which I have found it useful to alias:</p>
<div class="hll"><pre><span></span><span class="c1"># File: .aliases</span>
<span class="nb">alias</span> <span class="nv">ceu</span><span class="o">=</span><span class="s2">&quot;conda env update&quot;</span>
<span class="nb">alias</span> <span class="nv">cl</span><span class="o">=</span><span class="s2">&quot;conda list&quot;</span>
<span class="nb">alias</span> <span class="nv">ci</span><span class="o">=</span><span class="s2">&quot;conda install&quot;</span>
<span class="nb">alias</span> <span class="nv">cr</span><span class="o">=</span><span class="s2">&quot;conda remove&quot;</span>
</pre></div>
<p>Make sure your aliases don't clash with existing commands that you use!</p>
<p>Then, source <code>.aliases</code> in your <code>. bashrc</code>:</p>
<div class="hll"><pre><span></span><span class="c1"># File: .bashrc</span>
<span class="nb">source</span> /path/to/.aliases
</pre></div>
<p>Now, all of your defined aliases will be available in your bash shell.</p>
<p>The idea/pattern, as I mentioned earlier, is generalizable beyond just bash commands. (I have <code>ls</code> aliased for <code>exa</code>, and <code>l</code> aliased for <code>ls</code> - the epitome of laziness!)</p>
<h2 id="conclusion">Conclusion</h2><p>I hope you found these bash and <code>conda</code> hacks to be useful. Hopefully they will help you become more productive and efficient!</p>

</div>

<a name="disqus"></a>
<div class="comments">
<div id="disqus_thread"></div>
<script>
  var disqus_config = function() { this.page.identifier = "/blog/conda-hacks-for-data-science-efficiency"; this.page.url = "http://www.ericmjl.com/blog/2018/12/25/conda-hacks-for-data-science-efficiency/"; };
  (function() {
    var d = document, s = d.createElement('script');
    s.src = '//ericmjl.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>
  Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript"
    rel="nofollow">comments powered by Disqus.</a>
</noscript>
</div>

    </div>

    <nav class="navbar navbar-expand-sm navbar-dark fixed-bottom bg-dark-nord">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
            data-target="#external-links" aria-controls="navbarSupportedContent" aria-expanded="false"
            aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="external-links">
            <ul class="navbar-nav mr-auto">
                
                <li class="nav-item">
                    <a class="nav-link" href="https://www.linkedin.com/in/ericmjl"><i class="fab fa-linkedin" aria-hidden="true"></i>
                        LinkedIn</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="http://twitter.com/ericmjl"><i class="fab fa-twitter" aria-hidden="true"></i>
                        Twitter</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://octodon.social/web/accounts/7711"><i class="fab fa-mastodon" aria-hidden="true"></i>
                        Octodon</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="http://github.com/ericmjl"><i class="fab fa-github" aria-hidden="true"></i>
                        GitHub</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="http://stackoverflow.com/users/1274908/ericmjl"><i class="fab fa-stack-overflow" aria-hidden="true"></i>
                        Stack Overflow</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="http://shortwhale.com/ericmjl"><i class="far fa-envelope" aria-hidden="true"></i>
                        Contact Me</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://ericmjl.github.io/blog.xml"><i class="fas fa-rss" aria-hidden="true"></i>
                        Blog RSS</a>
                </li>
                
            </ul>
        </div>
    </nav>
    <!-- Boostrap JS imports -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>
</body>
